<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Execution Trace - Live Terminal Simulation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #00ff00;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #00ff00;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 5px #00ff00; }
            to { text-shadow: 0 0 20px #00ff00, 0 0 30px #00ff00; }
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .planned-notice {
            background: rgba(255, 165, 0, 0.1);
            border: 2px solid #FFA500;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .planned-notice-title {
            color: #FFA500;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .planned-notice-text {
            color: #ccc;
            font-size: 0.9em;
        }

        .workflow-selector {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .workflow-btn {
            padding: 15px;
            background: #1a1a1a;
            border: 2px solid #00ff00;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 0.9em;
        }

        .workflow-btn:hover {
            background: #00ff00;
            color: #000;
        }

        .workflow-btn.active {
            background: #00ff00;
            color: #000;
            font-weight: bold;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .terminal-container {
            background: #000;
            border: 2px solid #00ff00;
            border-radius: 5px;
            padding: 20px;
            height: 700px;
            overflow-y: auto;
            font-size: 0.85em;
            line-height: 1.4;
        }

        .terminal-header {
            color: #00ff00;
            font-size: 1.2em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #00ff00;
        }

        .terminal-line {
            margin: 4px 0;
            padding-left: 10px;
            opacity: 0;
            animation: fadeIn 0.3s forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .log-system { color: #00ff00; }
        .log-phase { color: #ffff00; font-weight: bold; }
        .log-hook { color: #ff00ff; }
        .log-tool { color: #00ffff; }
        .log-state { color: #ff6600; }
        .log-user-input {
            color: #ffffff;
            font-weight: bold;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px;
            margin: 8px 0;
            border-left: 3px solid #ffffff;
        }
        .log-user { color: #ffffff; font-weight: bold; }
        .log-error { color: #ff0000; }
        .log-success { color: #00ff00; font-weight: bold; }
        .log-wait { color: #ffaa00; animation: blink 1s infinite; }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .separator {
            border-top: 1px dashed #333;
            margin: 10px 0;
        }

        .todo-sidebar {
            background: #1a1a1a;
            border: 2px solid #00ff00;
            border-radius: 5px;
            padding: 20px;
            height: 700px;
            overflow-y: auto;
        }

        .todo-header {
            color: #00ff00;
            font-size: 1.2em;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #00ff00;
        }

        .todo-item {
            background: #0a0a0a;
            border-left: 3px solid #333;
            padding: 10px;
            margin: 8px 0;
            font-size: 0.85em;
        }

        .todo-item.pending {
            opacity: 0.4;
        }

        .todo-item.in_progress {
            border-left-color: #ffff00;
            background: rgba(255, 255, 0, 0.1);
            animation: pulse 2s infinite;
        }

        .todo-item.completed {
            border-left-color: #00ff00;
            opacity: 0.6;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .todo-checkbox {
            display: inline-block;
            width: 16px;
            margin-right: 8px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .control-btn {
            padding: 12px 25px;
            background: #1a1a1a;
            border: 2px solid #00ff00;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }

        .control-btn:hover {
            background: #00ff00;
            color: #000;
        }

        .control-btn.reset {
            border-color: #ff0000;
            color: #ff0000;
        }

        .control-btn.reset:hover {
            background: #ff0000;
            color: #fff;
        }

        .state-panel {
            background: #1a1a1a;
            border: 2px solid #ff6600;
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.8em;
        }

        .state-header {
            color: #ff6600;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .state-item {
            color: #ccc;
            margin: 5px 0;
        }

        .state-key {
            color: #ff6600;
        }

        .state-value {
            color: #00ff00;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #000;
        }

        ::-webkit-scrollbar-thumb {
            background: #00ff00;
            border-radius: 4px;
        }

        .interview-dialog {
            background: rgba(0, 0, 0, 0.95);
            border: 3px solid #ffff00;
            padding: 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .interview-question {
            color: #ffff00;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .interview-options {
            margin-left: 20px;
        }

        .interview-option {
            color: #00ffff;
            margin: 5px 0;
            cursor: pointer;
        }

        .interview-option:hover {
            color: #ffff00;
        }

        .selected-option {
            color: #00ff00;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° WORKFLOW EXECUTION TRACE ‚ö°</h1>
        <p class="subtitle">Live Terminal Simulation - Hooks ‚Ä¢ Skills ‚Ä¢ Interviews ‚Ä¢ State</p>

        <div class="planned-notice">
            <div class="planned-notice-title">‚ö†Ô∏è PLANNED IMPLEMENTATION - NOT CURRENT STATE</div>
            <div class="planned-notice-text">
                This demo shows how workflows WILL work AFTER TodoWrite integration is complete.
                Current state (v3.11.0) does NOT have TodoWrite - this is the FUTURE roadmap.
            </div>
        </div>

        <div class="workflow-selector">
            <button class="workflow-btn active" data-workflow="api-create">
                üì° API Create
            </button>
            <button class="workflow-btn" data-workflow="ui-component">
                üé® UI Component
            </button>
            <button class="workflow-btn" data-workflow="ui-page">
                üìÑ UI Page
            </button>
            <button class="workflow-btn" data-workflow="combine">
                üîó Combine APIs
            </button>
        </div>

        <div class="controls">
            <button class="control-btn" onclick="startExecution()">‚ñ∂ Start Execution</button>
            <button class="control-btn" onclick="pauseExecution()">‚è∏ Pause</button>
            <button class="control-btn" onclick="stepExecution()">‚è≠ Step Forward</button>
            <button class="control-btn reset" onclick="resetExecution()">‚Üª Reset</button>
        </div>

        <div class="main-grid">
            <div class="terminal-container" id="terminal">
                <div class="terminal-header">üñ•Ô∏è TERMINAL OUTPUT</div>
                <div id="terminal-content"></div>
            </div>

            <div>
                <div class="todo-sidebar">
                    <div class="todo-header">‚úì TodoWrite Progress</div>
                    <div id="todo-list"></div>
                </div>

                <div class="state-panel">
                    <div class="state-header">üìä State File (.claude/api-dev-state.json)</div>
                    <div id="state-content"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const workflows = {
            'api-create': {
                name: 'API Create - Stripe Payment',
                phases: [
                    {
                        name: 'User Request',
                        logs: [
                            { type: 'user-input', text: '$ /hustle-api-create stripe-payment' },
                            { type: 'user-input', text: '>>> User: "Create an endpoint for Stripe payment intents"' },
                            { type: 'separator' }
                        ]
                    },
                    {
                        name: 'Session Start',
                        logs: [
                            { type: 'system', text: 'üöÄ Agent: Starting /hustle-api-create stripe-payment...' },
                            { type: 'system', text: 'üìÇ Working directory: /Users/dev/project' },
                            { type: 'hook', text: 'üîó HOOK: session-startup.py triggered' },
                            { type: 'system', text: 'üìä Loading state from .claude/api-dev-state.json...' },
                            { type: 'state', text: 'State: { endpoint: null, turn_count: 0, workflow: null }' },
                            { type: 'hook', text: '‚úÖ HOOK: State context injected into conversation' },
                            { type: 'separator' }
                        ]
                    },
                    {
                        name: 'Phase 1: Disambiguation',
                        logs: [
                            { type: 'phase', text: '‚îÅ‚îÅ‚îÅ PHASE 1: DISAMBIGUATION ‚îÅ‚îÅ‚îÅ' },
                            { type: 'system', text: 'üîç Agent detected ambiguous term: "stripe"' },
                            { type: 'tool', text: 'üîß TOOL: WebSearch("stripe")' },
                            { type: 'system', text: '   Found: Stripe payment platform, stripe patterns in design' },
                            { type: 'tool', text: 'üîß TOOL: WebSearch("stripe API")' },
                            { type: 'system', text: '   Found: Stripe REST API documentation' },
                            { type: 'tool', text: 'üîß TOOL: WebSearch("stripe SDK npm")' },
                            { type: 'system', text: '   Found: stripe npm package (v14.x)' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üí¨ TOOL: AskUserQuestion (Agent)' },
                            { type: 'interview', question: 'What type of Stripe integration?', options: [
                                'REST API (direct HTTP calls)',
                                'Node.js SDK (@stripe/stripe-js)',
                                'Both (server + client)',
                                'Other (I\'ll specify)'
                            ]},
                            { type: 'wait', text: '‚è∏ WAITING FOR USER INPUT...' },
                            { type: 'user-input', text: '>>> User clicks: [2] Node.js SDK (@stripe/stripe-js)' },
                            { type: 'user', text: 'üë§ User confirmed: "Node.js SDK"' },
                            { type: 'separator' },
                            { type: 'hook', text: 'üîó HOOK: track-tool-use.py (PostToolUse)' },
                            { type: 'state', text: '   Logged: AskUserQuestion called at turn 3' },
                            { type: 'state', text: '   Update: phases.disambiguation.user_confirmed = true' },
                            { type: 'tool', text: 'üìù TOOL: TodoWrite' },
                            { type: 'system', text: '   ‚úì Phase 1: Disambiguation (COMPLETED)' },
                            { type: 'system', text: '   ‚äô Phase 2: Scope Confirmation (IN PROGRESS)' },
                            { type: 'separator' }
                        ]
                    },
                    {
                        name: 'Phase 2: Scope Confirmation',
                        logs: [
                            { type: 'phase', text: '‚îÅ‚îÅ‚îÅ PHASE 2: SCOPE CONFIRMATION ‚îÅ‚îÅ‚îÅ' },
                            { type: 'system', text: 'üìã Agent presenting understanding...' },
                            { type: 'system', text: '   Endpoint: /api/v2/stripe-payment' },
                            { type: 'system', text: '   Purpose: Create Stripe payment intent using Node.js SDK' },
                            { type: 'system', text: '   External API: Stripe API (via stripe npm package)' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üí¨ TOOL: AskUserQuestion (Agent)' },
                            { type: 'interview', question: 'Is this scope correct?', options: [
                                'Yes, proceed to research',
                                'I have modifications',
                                'No, start over'
                            ]},
                            { type: 'wait', text: '‚è∏ WAITING FOR USER INPUT...' },
                            { type: 'user-input', text: '>>> User clicks: [1] Yes, proceed to research' },
                            { type: 'user', text: 'üë§ User confirmed: "Yes, proceed"' },
                            { type: 'separator' },
                            { type: 'state', text: '   Update: phases.scope.status = "complete"' },
                            { type: 'state', text: '   Update: endpoint = "stripe-payment"' },
                            { type: 'tool', text: 'üìù TOOL: TodoWrite' },
                            { type: 'system', text: '   ‚úì Phase 2: Scope Confirmation (COMPLETED)' },
                            { type: 'system', text: '   ‚äô Phase 3: Initial Research (IN PROGRESS)' },
                            { type: 'separator' }
                        ]
                    },
                    {
                        name: 'Phase 3: Initial Research',
                        logs: [
                            { type: 'phase', text: '‚îÅ‚îÅ‚îÅ PHASE 3: INITIAL RESEARCH ‚îÅ‚îÅ‚îÅ' },
                            { type: 'hook', text: 'üîó HOOK: enforce-external-research.py (UserPromptSubmit)' },
                            { type: 'hook', text: '   ‚ö†Ô∏è Detected external API term: "stripe"' },
                            { type: 'hook', text: '   ‚úì Research requirement triggered' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: mcp__context7__resolve-library-id("stripe")' },
                            { type: 'system', text: '   Found: /stripe/stripe-node (v14.14.0)' },
                            { type: 'tool', text: 'üîß TOOL: mcp__context7__get-library-docs' },
                            { type: 'system', text: '   Retrieved: stripe.paymentIntents.create() documentation' },
                            { type: 'system', text: '   Found parameters: amount, currency, payment_method' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: WebSearch("stripe payment intents official docs")' },
                            { type: 'system', text: '   URL: https://stripe.com/docs/api/payment_intents' },
                            { type: 'tool', text: 'üîß TOOL: WebFetch(stripe docs URL)' },
                            { type: 'system', text: '   Discovered: 23 optional parameters' },
                            { type: 'system', text: '   Required: amount, currency' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: Write(.claude/research/stripe/2025-12-24_initial.md)' },
                            { type: 'hook', text: 'üîó HOOK: enforce-research.py (PreToolUse)' },
                            { type: 'hook', text: '   ‚úì Research found for "stripe" - allowing Write' },
                            { type: 'system', text: '   Research cached: 3 sources, 23 parameters documented' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üí¨ TOOL: AskUserQuestion' },
                            { type: 'interview', question: 'Proceed to interview or search more?', options: [
                                'Proceed to interview',
                                'Search more topics',
                                'Focus on specific parameter'
                            ]},
                            { type: 'wait', text: '‚è∏ WAITING FOR USER INPUT...' },
                            { type: 'user', text: 'üë§ User selected: "Proceed to interview"' },
                            { type: 'separator' },
                            { type: 'state', text: '   Update: phases.research_initial.status = "complete"' },
                            { type: 'state', text: '   Update: research_index.stripe.last_updated = "2025-12-24"' },
                            { type: 'tool', text: 'üìù TOOL: TodoWrite' },
                            { type: 'system', text: '   ‚úì Phase 3: Initial Research (COMPLETED)' },
                            { type: 'system', text: '   ‚äô Phase 4: Interview (IN PROGRESS)' },
                            { type: 'separator' }
                        ]
                    },
                    {
                        name: 'Phase 4: Interview',
                        logs: [
                            { type: 'phase', text: '‚îÅ‚îÅ‚îÅ PHASE 4: INTERVIEW ‚îÅ‚îÅ‚îÅ' },
                            { type: 'system', text: 'üìù Generating questions FROM research findings...' },
                            { type: 'system', text: '   NOT using generic templates' },
                            { type: 'system', text: '   Based on 23 discovered parameters' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üí¨ TOOL: AskUserQuestion (Agent asking Q1/5)' },
                            { type: 'interview', question: 'Which currencies do you need to support?', options: [
                                'USD only',
                                'USD, EUR, GBP',
                                'All Stripe currencies (multiSelect)'
                            ]},
                            { type: 'user-input', text: '>>> User clicks: [2] USD, EUR, GBP' },
                            { type: 'user', text: 'üë§ User answered: "USD, EUR, GBP"' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üí¨ TOOL: AskUserQuestion (Q2/5)' },
                            { type: 'interview', question: 'Error handling approach?', options: [
                                'Return error to client',
                                'Retry with exponential backoff',
                                'Log and return generic message'
                            ]},
                            { type: 'user', text: 'üë§ User selected: "Return error to client"' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üí¨ TOOL: AskUserQuestion (Q3/5)' },
                            { type: 'interview', question: 'Confirm payment immediately or require capture?', options: [
                                'Automatic capture',
                                'Manual capture later',
                                'Configurable per request'
                            ]},
                            { type: 'user', text: 'üë§ User selected: "Automatic capture"' },
                            { type: 'separator' },
                            { type: 'system', text: 'üìä Interview Summary:' },
                            { type: 'system', text: '   - Currencies: USD, EUR, GBP' },
                            { type: 'system', text: '   - Error handling: Return to client' },
                            { type: 'system', text: '   - Capture: Automatic' },
                            { type: 'separator' },
                            { type: 'state', text: '   Update: phases.interview.decisions = {...}' },
                            { type: 'state', text: '   Update: phases.interview.status = "complete"' },
                            { type: 'hook', text: 'üîó HOOK: track-tool-use.py (PostToolUse)' },
                            { type: 'hook', text: '   Turn count: 12 (5 turns remaining until re-ground)' },
                            { type: 'tool', text: 'üìù TOOL: TodoWrite' },
                            { type: 'system', text: '   ‚úì Phase 4: Interview (COMPLETED)' },
                            { type: 'system', text: '   ‚äô Phase 5: Deep Research (IN PROGRESS)' },
                            { type: 'separator' }
                        ]
                    },
                    {
                        name: 'Phase 8: TDD Red',
                        logs: [
                            { type: 'phase', text: '‚îÅ‚îÅ‚îÅ PHASE 8: TDD RED ‚îÅ‚îÅ‚îÅ' },
                            { type: 'system', text: 'üß™ Writing failing tests FIRST...' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: Write(stripe-payment/__tests__/route.test.ts)' },
                            { type: 'hook', text: 'üîó HOOK: enforce-research.py (PreToolUse)' },
                            { type: 'hook', text: '   ‚úì Research found for endpoint - allowing Write' },
                            { type: 'hook', text: 'üîó HOOK: enforce-interview.py (PreToolUse)' },
                            { type: 'hook', text: '   ‚úì Interview decisions found - injecting into context' },
                            { type: 'system', text: '   Decisions: currencies=[USD,EUR,GBP], capture=auto' },
                            { type: 'system', text: '   Test file created: 15 test scenarios' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: Bash(pnpm test stripe-payment)' },
                            { type: 'error', text: '   ‚ùå FAIL: Cannot find module /api/v2/stripe-payment/route' },
                            { type: 'success', text: '   ‚úì Tests failing as expected (Red phase success)' },
                            { type: 'separator' },
                            { type: 'state', text: '   Update: phases.tdd_red.status = "complete"' },
                            { type: 'tool', text: 'üìù TOOL: TodoWrite' },
                            { type: 'system', text: '   ‚úì Phase 8: TDD Red (COMPLETED)' },
                            { type: 'system', text: '   ‚äô Phase 9: TDD Green (IN PROGRESS)' },
                            { type: 'separator' }
                        ]
                    },
                    {
                        name: 'Phase 9: TDD Green',
                        logs: [
                            { type: 'phase', text: '‚îÅ‚îÅ‚îÅ PHASE 9: TDD GREEN ‚îÅ‚îÅ‚îÅ' },
                            { type: 'system', text: 'üíª Writing minimal implementation...' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: Write(api/v2/stripe-payment/route.ts)' },
                            { type: 'hook', text: 'üîó HOOK: verify-implementation.py (PreToolUse)' },
                            { type: 'hook', text: '   ‚úì Test file exists - allowing route implementation' },
                            { type: 'system', text: '   Route handler created: POST /api/v2/stripe-payment' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: Bash(pnpm test stripe-payment)' },
                            { type: 'system', text: '   Running 15 tests...' },
                            { type: 'success', text: '   ‚úì All 15 tests passing' },
                            { type: 'success', text: '   ‚úì Coverage: 100%' },
                            { type: 'separator' },
                            { type: 'state', text: '   Update: phases.tdd_green.status = "complete"' },
                            { type: 'state', text: '   Update: all_tests_passing = true' },
                            { type: 'hook', text: 'üîó HOOK: verify-after-green.py (PostToolUse)' },
                            { type: 'hook', text: '   ‚ö†Ô∏è Tests passed - triggering Phase 10 verification' },
                            { type: 'tool', text: 'üìù TOOL: TodoWrite' },
                            { type: 'system', text: '   ‚úì Phase 9: TDD Green (COMPLETED)' },
                            { type: 'system', text: '   ‚äô Phase 10: Verify (IN PROGRESS - AUTOMATIC)' },
                            { type: 'separator' }
                        ]
                    },
                    {
                        name: 'Phase 10: Verify',
                        logs: [
                            { type: 'phase', text: '‚îÅ‚îÅ‚îÅ PHASE 10: VERIFY ‚îÅ‚îÅ‚îÅ' },
                            { type: 'hook', text: 'üîó HOOK: verify-after-green.py AUTO-TRIGGERED' },
                            { type: 'system', text: 'üîç Re-researching documentation...' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: mcp__context7__get-library-docs(/stripe/stripe-node)' },
                            { type: 'system', text: '   Re-reading Stripe payment intents docs...' },
                            { type: 'tool', text: 'üîß TOOL: Read(api/v2/stripe-payment/route.ts)' },
                            { type: 'system', text: '   Comparing implementation to docs...' },
                            { type: 'separator' },
                            { type: 'system', text: 'üìä Gap Analysis:' },
                            { type: 'error', text: '   ‚ö†Ô∏è Missing: description parameter' },
                            { type: 'error', text: '   ‚ö†Ô∏è Missing: metadata parameter' },
                            { type: 'success', text: '   ‚úì All required params present' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üí¨ TOOL: AskUserQuestion' },
                            { type: 'interview', question: 'How to proceed with gaps?', options: [
                                'Fix gaps (loop to Red)',
                                'Skip (intentional omission)',
                                'Fix some, skip others'
                            ]},
                            { type: 'wait', text: '‚è∏ WAITING FOR USER INPUT...' },
                            { type: 'user', text: 'üë§ User selected: "Skip (intentional omission)"' },
                            { type: 'separator' },
                            { type: 'state', text: '   Update: phases.verify.status = "complete"' },
                            { type: 'state', text: '   Update: intentional_omissions = ["description", "metadata"]' },
                            { type: 'tool', text: 'üìù TOOL: TodoWrite' },
                            { type: 'system', text: '   ‚úì Phase 10: Verify (COMPLETED)' },
                            { type: 'system', text: '   ‚äô Phase 11: Refactor (IN PROGRESS)' },
                            { type: 'separator' }
                        ]
                    },
                    {
                        name: 'Phase 13: Completion',
                        logs: [
                            { type: 'phase', text: '‚îÅ‚îÅ‚îÅ PHASE 13: COMPLETION ‚îÅ‚îÅ‚îÅ' },
                            { type: 'system', text: 'üéØ Final verification...' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: Bash(pnpm test)' },
                            { type: 'success', text: '   ‚úì All tests passing' },
                            { type: 'tool', text: 'üîß TOOL: Bash(pnpm build)' },
                            { type: 'success', text: '   ‚úì TypeScript compiles without errors' },
                            { type: 'separator' },
                            { type: 'system', text: 'üìã Checklist:' },
                            { type: 'success', text: '   ‚úì All 13 phases complete' },
                            { type: 'success', text: '   ‚úì 100% test coverage' },
                            { type: 'success', text: '   ‚úì Docs updated' },
                            { type: 'success', text: '   ‚úì Research cached' },
                            { type: 'separator' },
                            { type: 'tool', text: 'üîß TOOL: Skill("commit")' },
                            { type: 'system', text: '   Running /commit...' },
                            { type: 'tool', text: 'üîß TOOL: Bash(git add .)' },
                            { type: 'tool', text: 'üîß TOOL: Bash(git commit -m "...")' },
                            { type: 'success', text: '   ‚úì Commit created with co-author attribution' },
                            { type: 'separator' },
                            { type: 'state', text: '   Update: phases.completion.status = "complete"' },
                            { type: 'tool', text: 'üìù TOOL: TodoWrite' },
                            { type: 'system', text: '   ‚úì Phase 13: Completion (COMPLETED)' },
                            { type: 'separator' },
                            { type: 'success', text: 'üéâ WORKFLOW COMPLETE - /api/v2/stripe-payment created!' },
                            { type: 'separator' }
                        ]
                    }
                ]
            }
        };

        let currentWorkflow = 'api-create';
        let currentPhaseIndex = 0;
        let currentLogIndex = 0;
        let executionInterval = null;
        let isPaused = false;

        function addLog(log) {
            const terminal = document.getElementById('terminal-content');
            const line = document.createElement('div');
            line.className = `terminal-line log-${log.type}`;

            if (log.type === 'separator') {
                line.className = 'separator';
            } else if (log.type === 'interview') {
                line.className = 'interview-dialog';
                line.innerHTML = `
                    <div class="interview-question">‚ùì ${log.question}</div>
                    <div class="interview-options">
                        ${log.options.map((opt, i) => `<div class="interview-option">  [${i+1}] ${opt}</div>`).join('')}
                    </div>
                `;
            } else {
                line.textContent = log.text;
            }

            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }

        function updateTodos() {
            const workflow = workflows[currentWorkflow];
            const todoList = document.getElementById('todo-list');
            const totalPhases = workflow.phases.length - 1; // -1 for session start

            todoList.innerHTML = workflow.phases.slice(1).map((phase, index) => {
                let status = 'pending';
                if (index < currentPhaseIndex) status = 'completed';
                if (index === currentPhaseIndex) status = 'in_progress';

                const checkbox = status === 'completed' ? '‚úì' : status === 'in_progress' ? '‚äô' : '‚òê';

                return `
                    <div class="todo-item ${status}">
                        <span class="todo-checkbox">${checkbox}</span>
                        <span>${phase.name}</span>
                    </div>
                `;
            }).join('');
        }

        function updateState() {
            const stateContent = document.getElementById('state-content');
            stateContent.innerHTML = `
                <div class="state-item">
                    <span class="state-key">endpoint:</span> <span class="state-value">"stripe-payment"</span>
                </div>
                <div class="state-item">
                    <span class="state-key">workflow:</span> <span class="state-value">"api-create"</span>
                </div>
                <div class="state-item">
                    <span class="state-key">turn_count:</span> <span class="state-value">${currentLogIndex}</span>
                </div>
                <div class="state-item">
                    <span class="state-key">current_phase:</span> <span class="state-value">${currentPhaseIndex + 1}</span>
                </div>
                <div class="state-item">
                    <span class="state-key">all_tests_passing:</span> <span class="state-value">${currentPhaseIndex >= 5 ? 'true' : 'false'}</span>
                </div>
            `;
        }

        function stepExecution() {
            const workflow = workflows[currentWorkflow];

            if (currentPhaseIndex >= workflow.phases.length) {
                clearInterval(executionInterval);
                return;
            }

            const currentPhase = workflow.phases[currentPhaseIndex];

            if (currentLogIndex < currentPhase.logs.length) {
                addLog(currentPhase.logs[currentLogIndex]);
                currentLogIndex++;
                updateState();
            } else {
                currentPhaseIndex++;
                currentLogIndex = 0;
                updateTodos();
            }
        }

        function startExecution() {
            if (executionInterval) return;
            executionInterval = setInterval(() => {
                if (!isPaused) stepExecution();
            }, 400); // 400ms between logs
        }

        function pauseExecution() {
            isPaused = !isPaused;
        }

        function resetExecution() {
            clearInterval(executionInterval);
            executionInterval = null;
            isPaused = false;
            currentPhaseIndex = 0;
            currentLogIndex = 0;
            document.getElementById('terminal-content').innerHTML = '';
            updateTodos();
            updateState();
        }

        // Workflow selection
        document.querySelectorAll('.workflow-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.workflow-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentWorkflow = btn.dataset.workflow;
                resetExecution();
            });
        });

        // Initialize
        updateTodos();
        updateState();
    </script>
</body>
</html>
